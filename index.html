<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¿æ€æœ‰é™å…¬å¸ 115 å¹´åº¦å®šæœŸå‹å‹•å¥‘ç´„ç°½ç½²</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* --- åŸºç¤é‡ç½® --- */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Microsoft JhengHei", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: #f4f4f4; padding: 10px; color: #333; letter-spacing: 0.5px; 
            overscroll-behavior: none; 
        }
        
        .container { 
            max-width: 800px; margin: 0 auto; background: white; padding: 20px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
        }

        /* --- ç·¨è¼¯æ¨¡å¼æ¨£å¼ --- */
        .edit-mode-only {
            background: #f8f9fa; padding: 20px; border-radius: 8px; border: 2px solid #007bff; 
            margin-top: 30px;
        }
        .form-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #007bff; text-align: center; border-bottom: 1px dashed #ccc; padding-bottom: 10px; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 16px; }
        
        input[type="text"], input[type="number"] { 
            width: 100%; padding: 12px; border: 1px solid #999; border-radius: 4px; 
            font-size: 16px; box-sizing: border-box; appearance: none;
        }

        .bank-group { display: flex; gap: 10px; flex-direction: column; }
        @media (min-width: 600px) { .bank-group { flex-direction: row; } }

        canvas { 
            border: 2px dashed #6c757d; background: #fff; cursor: crosshair; display: block; width: 100%; 
            touch-action: none; border-radius: 4px; 
        }
        .sig-buttons { margin-top: 8px; text-align: right; }

        /* =========================================
           PDF é é¢çµæ§‹æ¨£å¼ (é—œéµï¼šå®šç¾©ä¸‰é å…§å®¹)
           ========================================= */
        
        /* éš±è—ä¾†æº DOM */
        .pdf-source-container { display: none; }

        /* å®šç¾© PDF æ¯ä¸€é çš„ç‰©ç†å°ºå¯¸ (ç¢ºä¿ A4 ä¸è·‘ç‰ˆ) */
        .pdf-page {
            width: 780px; /* å›ºå®šå¯¬åº¦ï¼Œæ¨¡æ“¬ A4 */
            background: white;
            padding: 50px; 
            margin-bottom: 20px;
            color: #000;
            box-sizing: border-box;
            border: 1px solid #ccc;
            position: relative;
            /* è®“æ–‡å­—å¤§ä¸€é»ï¼Œé¿å…å£“ç¸® */
            font-size: 16px; 
        }

        /* é è¦½æ¨¡å¼å®¹å™¨ (æ‰‹æ©Ÿæ©«å‘æ²å‹•ä¿®å¾©) */
        #preview-scroll-window {
            display: none;
            width: 100%;
            overflow-x: auto; /* å…è¨±å·¦å³æ»‘å‹• */
            -webkit-overflow-scrolling: touch;
            background: #525659; 
            padding: 20px 10px;
            box-sizing: border-box;
            margin-top: 20px;
        }
        
        /* é è¦½å…§å®¹çš„å®¹å™¨ï¼Œå¼·åˆ¶å¯¬åº¦ */
        #preview-content-target {
            min-width: 800px; /* å¼·åˆ¶æ’é–‹å¯¬åº¦ï¼Œç¢ºä¿ä¸è¢«æ‰‹æ©Ÿè¢å¹•æ“ å£“ */
        }

        h1 { text-align: center; font-size: 24px; margin-bottom: 25px; border-bottom: 2px solid #333; padding-bottom: 15px; }
        h2 { font-size: 20px; background-color: #eee; padding: 10px; margin-top: 30px; border-left: 6px solid #2c3e50; font-weight: bold; }
        p { line-height: 1.8; margin-bottom: 15px; text-align: justify; }
        
        .contract-text { margin-bottom: 15px; line-height: 1.8; text-align: justify; }
        .contract-sub-title { font-weight: bold; margin-bottom: 5px; display: block; color: #000; }
        
        .sync-name { 
            border-bottom: 2px solid #000; min-width: 150px; display: inline-block; 
            text-align: center; font-weight: bold; font-size: 20px; padding: 0 10px;
        }

        /* ç”²æ–¹è³‡è¨Š */
        .party-a-section {
            margin-top: 40px; padding: 20px; border: 2px solid #333;
            background-color: #fff; line-height: 1.8;
        }

        /* ä¹™æ–¹é è¦½è¡¨æ ¼ */
        .preview-row { display: flex; border-bottom: 1px solid #ccc; padding: 12px 0; align-items: flex-end; }
        .preview-label { width: 140px; font-weight: bold; text-align: right; padding-right: 20px; flex-shrink: 0; white-space: nowrap; }
        .preview-value { flex-grow: 1; font-size: 18px; font-weight: 500; min-height: 24px; word-break: break-all; }
        #preview-sig-img { max-width: 300px; height: 100px; display: block; }

        /* åº•éƒ¨æŒ‰éˆ• */
        .action-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: #333; padding: 15px; text-align: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.2); display: flex; justify-content: center; gap: 10px; z-index: 999; }
        .btn { padding: 12px 15px; font-size: 16px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; min-width: 100px; }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .spacer { height: 100px; }
    </style>
</head>
<body>

<div class="container" id="input-form-container">
    <h1>ç¿æ€æœ‰é™å…¬å¸ 115 å¹´åº¦å®šæœŸå‹å‹•å¥‘ç´„ç°½ç½²</h1>
    <p>è«‹å¡«å¯«ä»¥ä¸‹æ¬„ä½ï¼Œå®Œæˆå¾Œé»æ“Šä¸‹æ–¹ã€Œé è¦½åˆç´„ã€é€²è¡Œç¢ºèªã€‚</p>
    
    <div class="edit-mode-only">
        <div class="form-title">ğŸ“ ä¹™æ–¹ï¼ˆå‹å·¥ï¼‰å¡«å¯«å€</div>
        <div class="input-group"><label>1. é›™æ–¹è­°å®šæ™‚è–ª (æ–°è‡ºå¹£/å°æ™‚)ï¼š</label><input type="number" id="hourlyRate" placeholder="ä¾‹å¦‚ï¼š500"></div>
        <div class="input-group"><label>2. å§“åï¼š</label><input type="text" id="signerName" placeholder="è«‹è¼¸å…¥çœŸå¯¦å§“å" oninput="syncName(this.value)"></div>
        <div class="input-group"><label>3. èº«åˆ†è­‰å­—è™Ÿï¼š</label><input type="text" id="signerID" placeholder="è«‹è¼¸å…¥èº«åˆ†è­‰å­—è™Ÿ"></div>
        <div class="input-group"><label>4. æˆ¶ç±/é€šè¨Šåœ°å€ï¼š</label><input type="text" id="signerAddress" placeholder="è«‹è¼¸å…¥å®Œæ•´åœ°å€"></div>
        <div class="input-group">
            <label>5. è–ªè³‡åŒ¯æ¬¾å¸³æˆ¶ï¼š</label>
            <div class="bank-group">
                <input type="text" id="bankName" placeholder="éŠ€è¡Œåç¨±">
                <input type="text" id="bankBranch" placeholder="åˆ†è¡Œåç¨±">
                <input type="text" id="bankAccount" placeholder="å¸³è™Ÿ">
            </div>
        </div>
        <div class="input-group">
            <label>6. ç°½ç½²æ—¥æœŸï¼š</label>
            <div style="font-size: 16px; padding: 10px; background: #e9ecef;" id="dateDisplayEdit">
                ä¸­è¯æ°‘åœ‹ 115 å¹´ <span id="signMonth"></span> æœˆ <span id="signDay"></span> æ—¥
            </div>
        </div>
        <div class="input-group">
            <label>7. ä¹™æ–¹é›»å­ç°½åï¼š</label>
            <canvas id="signaturePad" height="200"></canvas>
            <div class="sig-buttons"><button class="clear-btn" onclick="clearSignature()">æ¸…é™¤é‡ç°½</button></div>
        </div>
    </div>
    <div class="spacer"></div>
</div>

<div class="pdf-source-container">
    
    <div id="pdf-page-1" class="pdf-page">
        <h1>ç¿æ€æœ‰é™å…¬å¸ 115 å¹´åº¦å®šæœŸå‹å‹•å¥‘ç´„æ›¸ (æŒ‰æ‘©å¸«)</h1>
        <p>
            <strong>ç”²æ–¹ï¼ˆé›‡ä¸»ï¼‰ï¼š</strong> ç¿æ€æœ‰é™å…¬å¸<br>
            <strong>ä¹™æ–¹ï¼ˆå‹å·¥ï¼‰ï¼š</strong> <span id="displayTopName" class="sync-name"></span>
        </p>
        <p>æœ¬å¥‘ç´„å› åŸ·è¡Œåœ‹å®¶é‹å‹•è¨“ç·´ä¸­å¿ƒã€Œ115 å¹´åº¦åŸ¹è¨“éšŠé¸æ‰‹åŠæ•™ç·´æŒ‰æ‘©æœå‹™ï¼ˆé–‹å£å¥‘ç´„ï¼‰æ¡ˆã€ï¼ˆä»¥ä¸‹ç°¡ç¨±æœ¬å°ˆæ¡ˆï¼‰è€Œæˆç«‹ï¼Œé›™æ–¹åŒæ„æ¢æ¬¾å¦‚ä¸‹ï¼š</p>

        <h2>ä¸€ã€ è˜åƒ±æœŸé–“èˆ‡å·¥ä½œå…§å®¹</h2>
        <div class="contract-text"><span class="contract-sub-title">è˜åƒ±æœŸé–“ï¼š</span>è‡ª 115 å¹´ 1 æœˆ 1 æ—¥èµ·è‡³ 115 å¹´ 12 æœˆ 31 æ—¥æ­¢ã€‚è‹¥æœ¬å°ˆæ¡ˆå› æ©Ÿé—œéœ€æ±‚èª¿æ•´ã€é ä¼°æ™‚æ•¸æå‰åŸ·è¡Œå®Œç•¢æˆ–ä¸»æ¨™æ¡ˆå¥‘ç´„æå‰çµ‚æ­¢ï¼Œæœ¬å¥‘ç´„éš¨ä¹‹çµ‚æ­¢ï¼Œä¹™æ–¹ä¸å¾—è¦æ±‚ç”²æ–¹æ”¯ä»˜è³‡é£è²»æˆ–æå®³è³ å„Ÿã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">å·¥ä½œåœ°é»ï¼š</span>é«˜é›„å¸‚å·¦ç‡Ÿå€ä¸–é‹å¤§é“ 399 è™Ÿï¼ˆåœ‹å®¶é‹å‹•è¨“ç·´ä¸­å¿ƒï¼‰ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">å·¥ä½œå…§å®¹ï¼š</span>ç‚ºä¸­å¿ƒé¸æ‰‹åŠæ•™ç·´åŸ·è¡Œé‹å‹•æŒ‰æ‘©ã€æ²¹å£“ã€è…³åº•æŒ‰æ‘©ç­‰å°ˆæ¥­æ¢å¾©æœå‹™ã€‚</div>
        <div class="contract-text">
            <span class="contract-sub-title">å°ˆæ¥­è¦ç¯„èˆ‡å“è³ªæ§ç®¡ï¼š</span>
            ä¹™æ–¹æ‰¿è«¾å…¨ç¨‹æ¡ç´”å¾’æ‰‹æŒ‰æ‘©ï¼Œåš´ç¦ä½¿ç”¨ç­‹è†œåˆ€ã€æ²»ç™‚å„€å™¨ã€æ‹”ç½åŠåˆ®ç—§ç­‰éå¾’æ‰‹å·¥å…·ã€‚<br>
            <strong>è€—æèˆ‡è¨­å‚™ï¼š</strong>ç›¸é—œæ¶ˆè€—æ€§ææ–™ï¼ˆå¦‚ç²¾æ²¹ã€ä¹³æ¶²ï¼‰ç”±ç”²æ–¹çµ±ä¸€æä¾›ï¼Œä¹™æ–¹ä¸å¾—ç§è‡ªä½¿ç”¨æœªç¶“ç”²æ–¹æ ¸å¯ä¹‹ç”¢å“ï¼Œä»¥ç¢ºä¿æœå‹™å“è³ªèˆ‡é¸æ‰‹çš®è†šå®‰å…¨ã€‚
        </div>

        <h2>äºŒã€ å·¥ä½œæ™‚é–“èˆ‡æ’ç­</h2>
        <div class="contract-text"><span class="contract-sub-title">æœå‹™æ™‚æ®µï¼š</span>åŸå‰‡ç‚ºé€±ä¸€è‡³é€±äº” 17:50 è‡³ 20:50ã€‚æ™‚æ®µå¤šå¯¡å°‡è¦–ä¸­å¿ƒéœ€æ±‚ï¼ˆå¦‚ç¸½é›†è¨“ã€äºé‹æœŸé–“ï¼‰é€²è¡Œèª¿æ•´ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">æ’ç­æ©Ÿåˆ¶ï¼š</span>æ¡å…¨é ç´„åˆ¶ã€‚ç”²æ–¹å°‡æ–¼æ¯æœˆ 15 æ—¥å‰æ’å®šæ¬¡æœˆåå–®ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">ä¸€èˆ¬è«‹å‡ï¼š</span>ä¹™æ–¹è‹¥å› å€‹äººäº‹å‹™éœ€èª¿æ•´å·²æ’å®šä¹‹ç­è¡¨ï¼Œæ‡‰æ–¼æœå‹™æ—¥ 7 æ—¥å‰å‘ŠçŸ¥ç”²æ–¹ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">ä»£ç­è²¬ä»»æ­¸å±¬ï¼š</span>é‡å°ä¹™æ–¹æå‡ºä¹‹æ›ç­è«‹æ±‚ï¼Œç”²æ–¹å¾—å”åŠ©æ–¼å°ˆæ¡ˆäººæ‰åº«ä¸­è«®è©¢å…¶ä»–è€å¸«ä¹‹ä»£ç­æ„é¡˜ï¼ŒæƒŸç”²æ–¹ä¸è² ä¿è­‰å°‹å¾—æ›¿è£œäººå“¡ä¹‹ç¾©å‹™ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">é•ç´„èªå®šï¼š</span>è‹¥ç¶“ç”²æ–¹å”åŠ©è«®è©¢å¾Œä»æœªèƒ½å°‹å¾—ä»£ç­äººï¼Œä¹™æ–¹ä»æ‡‰ä¾åŸæ’å®šç­è¡¨å‡ºå‹¤ã€‚è‹¥ä¹™æ–¹æœ€çµ‚æœªèƒ½å‡ºå‹¤ï¼Œè¦–åŒä¹™æ–¹é•ç´„ï¼Œç”²æ–¹å¾—ä¾æœ¬å¥‘ç´„ç¬¬å››æ¢ä¹‹è¦ç¯„æ‰£é™¤é•ç´„é‡‘æˆ–çµ‚æ­¢å¥‘ç´„ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">ç·Šæ€¥äº‹æ•…ï¼š</span>åƒ…é™çªç™¼å‚·ç—…æˆ–ä¸€è¦ªç­‰å…§é‡å¤§è®Šæ•…ï¼ˆéœ€æä¾›è¨ºæ–·è­‰æ˜æˆ–ç›¸é—œä½è­‰ï¼‰ï¼Œå‰‡ä¸åœ¨æ­¤é™ã€‚</div>
    </div>

    <div id="pdf-page-2" class="pdf-page">
        <h2>ä¸‰ã€ è–ªè³‡çµ¦ä»˜èˆ‡æˆæ¬Šæ¢æ¬¾</h2>
        <div class="contract-text"><span class="contract-sub-title">è–ªè³‡æ¨™æº–ï¼š</span>ä¹™æ–¹è–ªè³‡ä»¥å¯¦éš›æœå‹™å°æ™‚è¨ˆç®—ï¼Œæ™‚è–ªä»¥é›™æ–¹é›»è©±è­°å®šå¾Œæ–¼ä¸‹æ–¹ã€Œç´„å®šæœå‹™æ™‚è–ªã€æ¬„ä½å¡«å¯«ä¹‹é‡‘é¡ç‚ºæº–ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">çµ¦ä»˜æ—¥æœŸï¼š</span>ç”²æ–¹æ‡‰æ–¼æ¯æœˆåº•æé€ç™¼ç¥¨ï¼Œä¿Ÿä¸­å¿ƒæ’¥ä»˜åƒ¹é‡‘å¾Œï¼ˆé è¨ˆæ¯æœˆåˆï¼‰ï¼Œæ–¼ 5 å€‹å·¥ä½œæ—¥å…§åŒ¯å…¥ä¹™æ–¹æŒ‡å®šå¸³æˆ¶ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">ä¸­å¿ƒä»£ä»˜æˆæ¬Šï¼š</span>ä¹™æ–¹åŒæ„ï¼Œè‹¥ç”²æ–¹æœªä¾é™çµ¦ä»˜è–ªè³‡ä¸”ç¶“ä¸­å¿ƒå‚¬å‘Šä»æœªæ”¹æ­£è€…ï¼Œç”²æ–¹åŒæ„ç”±ä¸­å¿ƒå°‡æ‡‰çµ¦ä»˜ç”²æ–¹ä¹‹åƒ¹é‡‘ç›´æ¥æ’¥ä»˜äºˆä¹™æ–¹ã€‚</div>

        <h2>å››ã€ æœå‹™å“è³ªèˆ‡è¡Œæ”¿é…åˆ</h2>
        <div class="contract-text"><span class="contract-sub-title">å€‹è³‡èˆ‡å ±å‚™æˆæ¬Šï¼š</span>ä¹™æ–¹åŒæ„å°‡èº«åˆ†è­‰å½±æœ¬ã€è­‰ç…§å½±æœ¬ã€æ€§å¹³å—è¨“è­‰æ˜åŠç›¸é—œå€‹è³‡æä¾›äºˆç”²æ–¹ï¼Œä¸¦æˆæ¬Šç”²æ–¹æäº¤äºˆåœ‹å®¶é‹å‹•è¨“ç·´ä¸­å¿ƒè¾¦ç†å…¥å…§å ±å‚™ã€è³‡æ ¼å¯©æŸ¥åŠä¿å¯†åˆ‡çµã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">æ•™è‚²è¨“ç·´ï¼š</span>ä¹™æ–¹æ‡‰æ–¼åˆ°è·å‰å®Œæˆ 2 å°æ™‚æ€§åˆ¥å¹³ç­‰æ•™è‚²è¨“ç·´ï¼Œä¸¦æäº¤è­‰æ˜æ–‡ä»¶ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">å·¥ä½œå®ˆå‰‡ï¼š</span>ä¹™æ–¹æ‡‰ç°½ç½²ä¸¦éµå®ˆã€Œä¸­å¿ƒæŒ‰æ‘©æœå‹™äººå“¡å·¥ä½œå®ˆå‰‡ã€ï¼ŒåŒ…å«åš´ç¦èˆ‡é¸æ‰‹é–’èŠã€åˆç…§æˆ–äº¤æ›ç¤¾ç¾¤è»Ÿé«”è¯ç¹«æ–¹å¼ï¼ˆå¦‚ Lineã€IGï¼‰ã€‚</div>
        <div class="contract-text">
            <span class="contract-sub-title">å“è³ªè€ƒæ ¸èˆ‡é•è¦ï¼š</span>
            è‹¥é¸æ‰‹æ»¿æ„åº¦è©•åˆ†ä½æ–¼ 4 åˆ†ï¼Œä¹™æ–¹æ‡‰é…åˆæäº¤æª¢è¨å ±å‘Šï¼›è‹¥ä½æ–¼ 3 åˆ†ï¼Œç”²æ–¹å¾—ç«‹å³åœæ­¢æ’ç­ä¸¦çµ‚æ­¢å¥‘ç´„ã€‚<br>
            ä¹™æ–¹è‹¥é²åˆ°ï¼ˆæ¯ 10 åˆ†é˜è¨ˆç½° 300 å…ƒï¼‰æˆ–é•åè¦ç¯„å°è‡´ä¸­å¿ƒå°ç”²æ–¹è¨ˆç½°ï¼Œè©²ç½°æ¬¾ç”±ä¹™æ–¹è–ªè³‡ä¸­æ‰£é™¤ã€‚
        </div>

        <h2>äº”ã€ å‹å·¥æ¬Šç›Šèˆ‡ä¿éšªé…å¥—</h2>
        <div class="contract-text"><span class="contract-sub-title">æ€§å¹³ä¿éšœï¼š</span>ç”²æ–¹è½å¯¦ã€Šæ€§åˆ¥å¹³ç­‰å·¥ä½œæ³•ã€‹ç›¸é—œæªæ–½ï¼Œä¿éšœä¹™æ–¹ç”³è¨´æ¬Šåˆ©ã€‚</div>
        <div class="contract-text"><span class="contract-sub-title">å‹è·ä¿æŠ•ä¿é…å¥—ï¼š</span>ç”²æ–¹ä¾è¦ç‚ºä¹™æ–¹æŠ•ä¿å‹ä¿ã€è·ä¿åŠå¥ä¿ã€‚ä¹™æ–¹æ‡‰æ–¼ç°½ç´„æ™‚æä¾›æ­£ç¢ºä¹‹æŠ•ä¿èˆ‡è–ªè³‡åŒ¯æ¬¾è³‡æ–™ï¼Œè‹¥å› è³‡æ–™æä¾›å»¶é²æˆ–éŒ¯èª¤å°è‡´æŠ•ä¿ã€æ’¥è–ªä½œæ¥­å»¶èª¤ï¼Œè²¬ä»»ç”±ä¹™æ–¹è‡ªè² ã€‚</div>

        <h2>å…­ã€ ä¿å¯†ç¾©å‹™</h2>
        <p>ä¹™æ–¹å°æ–¼å› åŸ·è¡Œè·å‹™æ‰€çŸ¥æ‚‰ä¹‹ä¸­å¿ƒå…¬å‹™ç§˜å¯†ã€é¸æ‰‹å€‹äººè³‡æ–™åŠéš±ç§ï¼Œè² æœ‰çµ•å°ä¿å¯†ä¹‹ç¾©å‹™ï¼Œä¸å› å¥‘ç´„çµ‚æ­¢è€Œè§£é™¤ã€‚</p>
    </div>

    <div id="pdf-page-3" class="pdf-page">
        <h2>ä¸ƒã€ æ³•å¾‹ç®¡è½„</h2>
        <p>æœ¬å¥‘ç´„å¦‚æœ‰çˆ­è­°ï¼Œé›™æ–¹åŒæ„ä»¥è‡ºç£é«˜é›„åœ°æ–¹æ³•é™¢ç‚ºç¬¬ä¸€å¯©ç®¡è½„æ³•é™¢ã€‚</p>

        <div class="party-a-section">
            <strong>ç”²æ–¹ï¼š</strong> ç¿æ€æœ‰é™å…¬å¸ <br>
            <strong>ä»£è¡¨äººï¼š</strong> è”¡æƒ å©· <br>
            <strong>çµ±ä¸€ç·¨è™Ÿï¼š</strong> 90048526 
        </div>

        <div style="font-weight: bold; margin-bottom: 15px; font-size: 18px; margin-top: 30px;">ä¹™æ–¹ï¼ˆå‹å·¥ï¼‰ï¼š</div>
        
        <div class="preview-row"><div class="preview-label">å§“åï¼š</div><div class="preview-value" id="pv_signerName"></div></div>
        <div class="preview-row"><div class="preview-label">èº«åˆ†è­‰å­—è™Ÿï¼š</div><div class="preview-value" id="pv_signerID"></div></div>
        <div class="preview-row"><div class="preview-label">è¯çµ¡åœ°å€ï¼š</div><div class="preview-value" id="pv_signerAddress"></div></div>
        <div class="preview-row"><div class="preview-label">ç´„å®šæ™‚è–ªï¼š</div><div class="preview-value"><span id="pv_hourlyRate"></span> <span class="unit-text">å…ƒ/å°æ™‚</span></div></div>
        <div class="preview-row"><div class="preview-label">è–ªè³‡å¸³æˆ¶ï¼š</div><div class="preview-value" id="pv_bankFull"></div></div>
        <div class="preview-row"><div class="preview-label">ç°½ç½²æ—¥æœŸï¼š</div><div class="preview-value" id="pv_dateFull"></div></div>
        <div class="preview-row" style="border-bottom: none; margin-top: 20px;">
            <div class="preview-label">ç°½ç« ï¼š</div>
            <div class="preview-value"><img id="preview-sig-img" src="" alt="ç°½åè¼‰å…¥ä¸­" /></div>
        </div>
    </div>
</div>

<div id="preview-scroll-window">
    <div id="preview-content-target"></div>
</div>
<div id="mobile-hint" style="display:none; text-align:center; color:#e74c3c; padding: 10px; font-weight:bold;">
    ğŸ’¡ æ‰‹æ©Ÿç”¨æˆ¶è«‹ã€Œå·¦å³æ»‘å‹•ã€ç°è‰²å€åŸŸä»¥æª¢æŸ¥å®Œæ•´åˆç´„ï¼Œç¢ºèªç„¡èª¤å¾Œå†é€å‡ºã€‚
</div>

<div class="action-bar" id="editBtns">
    <button class="btn btn-primary" onclick="togglePreview(true)">é è¦½åˆç´„</button>
</div>
<div class="action-bar" id="previewBtns" style="display:none;">
    <button class="btn btn-secondary" onclick="togglePreview(false)">è¿”å›ä¿®æ”¹</button>
    <button class="btn btn-success" id="submitBtn" onclick="generateAndSend()">ç¢ºèªé€å‡º</button>
</div>

<script>
    window.onload = function() {
        const today = new Date();
        document.getElementById('signMonth').innerText = today.getMonth() + 1;
        document.getElementById('signDay').innerText = today.getDate();
        resizeCanvas();
    };

    function syncName(val) {
        const display = document.getElementById('displayTopName');
        display.innerText = val ? val : "";
        display.style.textDecoration = val ? "underline" : "none";
    }

    var canvas = document.getElementById('signaturePad');
    var ctx = canvas.getContext('2d');
    var isDrawing = false;

    function resizeCanvas() {
        var ratio = Math.max(window.devicePixelRatio || 1, 1);
        canvas.width = canvas.offsetWidth * ratio;
        canvas.height = canvas.offsetHeight * ratio;
        ctx.scale(ratio, ratio);
    }
    
    function getPos(e) {
        var rect = canvas.getBoundingClientRect();
        var clientX = e.touches ? e.touches[0].clientX : e.clientX;
        var clientY = e.touches ? e.touches[0].clientY : e.clientY;
        return { x: clientX - rect.left, y: clientY - rect.top };
    }

    canvas.addEventListener('mousedown', startDraw);
    canvas.addEventListener('touchstart', startDraw, {passive: false});
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('touchmove', draw, {passive: false});
    canvas.addEventListener('mouseup', stopDraw);
    canvas.addEventListener('touchend', stopDraw);

    function startDraw(e) { isDrawing = true; ctx.beginPath(); var pos = getPos(e); ctx.moveTo(pos.x, pos.y); e.preventDefault(); }
    function draw(e) { if(!isDrawing) return; var pos = getPos(e); ctx.lineTo(pos.x, pos.y); ctx.stroke(); e.preventDefault(); }
    function stopDraw() { isDrawing = false; }
    function clearSignature() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

    function togglePreview(show) {
        const inputContainer = document.getElementById('input-form-container');
        const previewWindow = document.getElementById('preview-scroll-window');
        const mobileHint = document.getElementById('mobile-hint');
        const previewTarget = document.getElementById('preview-content-target');

        if(show) {
            if(!document.getElementById('signerName').value) { alert("è«‹è‡³å°‘å¡«å¯«å§“å"); return; }
            
            document.getElementById('pv_signerName').innerText = document.getElementById('signerName').value;
            document.getElementById('pv_signerID').innerText = document.getElementById('signerID').value;
            document.getElementById('pv_signerAddress').innerText = document.getElementById('signerAddress').value;
            document.getElementById('pv_hourlyRate').innerText = document.getElementById('hourlyRate').value;
            var bank = (document.getElementById('bankName').value || "") + " " + (document.getElementById('bankBranch').value || "") + " " + (document.getElementById('bankAccount').value || "");
            document.getElementById('pv_bankFull').innerText = bank;
            document.getElementById('pv_dateFull').innerText = document.getElementById('dateDisplayEdit').innerText.trim();
            document.getElementById('preview-sig-img').src = canvas.toDataURL('image/png');

            previewTarget.innerHTML = "";
            previewTarget.appendChild(document.getElementById('pdf-page-1').cloneNode(true));
            previewTarget.appendChild(document.getElementById('pdf-page-2').cloneNode(true));
            previewTarget.appendChild(document.getElementById('pdf-page-3').cloneNode(true));

            inputContainer.style.display = 'none';
            previewWindow.style.display = 'block';
            mobileHint.style.display = 'block';
            document.getElementById('editBtns').style.display = 'none';
            document.getElementById('previewBtns').style.display = 'flex';
            window.scrollTo(0, 0);
        } else {
            inputContainer.style.display = 'block';
            previewWindow.style.display = 'none';
            mobileHint.style.display = 'none';
            document.getElementById('editBtns').style.display = 'flex';
            document.getElementById('previewBtns').style.display = 'none';
        }
    }

    async function createPDFBlob() {
        const opts = { scale: 2, useCORS: true, windowWidth: 1200 };
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pdfWidth = 210;

        // çµ•å°ç¡¬å¼åˆ†é ï¼šPage 1
        const canvas1 = await html2canvas(document.getElementById('pdf-page-1'), opts);
        const imgHeight1 = (canvas1.height * pdfWidth) / canvas1.width;
        pdf.addImage(canvas1.toDataURL('image/jpeg', 0.9), 'JPEG', 0, 0, pdfWidth, imgHeight1);

        // Page 2
        pdf.addPage();
        const canvas2 = await html2canvas(document.getElementById('pdf-page-2'), opts);
        const imgHeight2 = (canvas2.height * pdfWidth) / canvas2.width;
        pdf.addImage(canvas2.toDataURL('image/jpeg', 0.9), 'JPEG', 0, 0, pdfWidth, imgHeight2);

        // Page 3
        pdf.addPage();
        const canvas3 = await html2canvas(document.getElementById('pdf-page-3'), opts);
        const imgHeight3 = (canvas3.height * pdfWidth) / canvas3.width;
        pdf.addImage(canvas3.toDataURL('image/jpeg', 0.9), 'JPEG', 0, 0, pdfWidth, imgHeight3);

        return pdf;
    }

    async function generateAndSend() {
        const btn = document.getElementById('submitBtn');
        btn.disabled = true;
        btn.innerText = "å‚³é€ä¸­...";

        try {
            const pdf = await createPDFBlob();
            const pdfBase64 = pdf.output('datauristring');
            const name = document.getElementById('signerName').value;
            const scriptURL = "https://script.google.com/macros/s/AKfycbzHaJLHFBdvM3NPYqP4yrJPx84wX6tPK54JNtUIqaJ6GDH7G4X5ZknwmVvrDgU49-DH/exec"; 

            await fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'text/plain' },
                body: JSON.stringify({ fileName: `${name}_115å¹´åº¦å®šæœŸå‹å‹•å¥‘ç´„.pdf`, fileData: pdfBase64 })
            });

            alert(`âœ… ç°½ç½²æˆåŠŸï¼å·²å‚³é€è‡³å…¬å¸æ­¸æª”ã€‚\n\nã€è«‹æˆªåœ–ç•™å­˜ã€‘ï¼šæ‚¨ç¾åœ¨çœ‹åˆ°çš„ä¸‰é åˆç´„ç•«é¢å³ç‚ºæœ€çµ‚ç‰ˆæœ¬ï¼Œè«‹ç›´æ¥æˆªåœ–ä¿å­˜ã€‚\n\næ­£å¼ç”¨å°åˆç´„å°‡æ–¼å…¬å¸ä½œæ¥­å®Œæˆå¾Œæä¾›ã€‚`);
            btn.innerText = "å·²å®Œæˆ (è«‹æˆªåœ–ç•™å­˜)";
        } catch (err) {
            console.error(err);
            alert("âš ï¸ å‚³é€å¤±æ•—ã€‚è«‹æª¢æŸ¥ç¶²è·¯é€£ç·šã€‚");
            btn.disabled = false;
            btn.innerText = "é‡è©¦";
        }
    }
</script>
</body>
</html>
